/home/ivlabs/anaconda3/envs/nlp2/lib/python3.12/site-packages/torch/cuda/__init__.py:141: UserWarning: CUDA initialization: The NVIDIA driver on your system is too old (found version 11040). Please update your GPU driver by downloading and installing a new version from the URL: http://www.nvidia.com/Download/index.aspx Alternatively, go to: https://pytorch.org to install a PyTorch version that has been compiled with your version of the CUDA driver. (Triggered internally at ../c10/cuda/CUDAFunctions.cpp:108.)
  return torch._C._cuda_getDeviceCount() > 0
cpu
torch.Size([16, 100])
torch.Size([16, 6, 6])
torch.Size([16, 6, 6])
Alpha torch.Size([16, 2, 100])
torch.Size([16, 2, 100])
<built-in method type of Tensor object at 0x7f0210782760>
torch.Size([16, 6, 6])
Alpha torch.Size([16, 3, 100])
torch.Size([16, 3, 100])
<built-in method type of Tensor object at 0x7f0210782760>
torch.Size([16, 6, 6])
Alpha torch.Size([16, 4, 100])
torch.Size([16, 4, 100])
<built-in method type of Tensor object at 0x7f0210782760>
torch.Size([16, 6, 6])
Alpha torch.Size([16, 5, 100])
torch.Size([16, 5, 100])
<built-in method type of Tensor object at 0x7f0210782760>
torch.Size([16, 6, 6])
Alpha torch.Size([16, 5, 100])
torch.Size([16, 5, 100])
<built-in method type of Tensor object at 0x7f0210782760>
torch.Size([16, 6, 6])
Alpha torch.Size([16, 5, 100])
torch.Size([16, 5, 100])
<built-in method type of Tensor object at 0x7f0210782760>
torch.Size([16, 6, 6])
Alpha torch.Size([16, 5, 100])
torch.Size([16, 5, 100])
<built-in method type of Tensor object at 0x7f0210782760>
torch.Size([16, 6, 6])
Alpha torch.Size([16, 5, 100])
torch.Size([16, 5, 100])
<built-in method type of Tensor object at 0x7f0210782760>
torch.Size([16, 6, 6])
Alpha torch.Size([16, 5, 100])
torch.Size([16, 5, 100])
<built-in method type of Tensor object at 0x7f0210782760>
torch.Size([16, 6, 6])
Alpha torch.Size([16, 5, 100])
torch.Size([16, 5, 100])
<built-in method type of Tensor object at 0x7f0210782760>
torch.Size([16, 6, 6])
Alpha torch.Size([16, 5, 100])
torch.Size([16, 5, 100])
<built-in method type of Tensor object at 0x7f0210782760>
torch.Size([16, 6, 6])
Alpha torch.Size([16, 5, 100])
torch.Size([16, 5, 100])
<built-in method type of Tensor object at 0x7f0210782760>
torch.Size([16, 6, 6])
Alpha torch.Size([16, 5, 100])
torch.Size([16, 5, 100])
<built-in method type of Tensor object at 0x7f0210782760>
torch.Size([16, 6, 6])
Alpha torch.Size([16, 5, 100])
torch.Size([16, 5, 100])
<built-in method type of Tensor object at 0x7f0210782760>
torch.Size([16, 6, 6])
Alpha torch.Size([16, 5, 100])
torch.Size([16, 5, 100])
<built-in method type of Tensor object at 0x7f0210782760>
torch.Size([16, 6, 6])
Alpha torch.Size([16, 5, 100])
torch.Size([16, 5, 100])
<built-in method type of Tensor object at 0x7f0210782760>
torch.Size([16, 6, 6])
Alpha torch.Size([16, 5, 100])
torch.Size([16, 5, 100])
<built-in method type of Tensor object at 0x7f0210782760>
torch.Size([16, 6, 6])
Alpha torch.Size([16, 5, 100])
torch.Size([16, 5, 100])
<built-in method type of Tensor object at 0x7f0210782760>
torch.Size([16, 6, 6])
Alpha torch.Size([16, 5, 100])
torch.Size([16, 5, 100])
<built-in method type of Tensor object at 0x7f0210782760>
torch.Size([16, 6, 6])
Alpha torch.Size([16, 5, 100])
torch.Size([16, 5, 100])
<built-in method type of Tensor object at 0x7f0210782760>
torch.Size([16, 6, 6])
Alpha torch.Size([16, 5, 100])
torch.Size([16, 5, 100])
<built-in method type of Tensor object at 0x7f0210782760>
Traceback (most recent call last):
  File "/home/ivlabs/repos/tfs/tranlslation-deq-main/train.py", line 86, in <module>
    x_out,output,output_exp = anderson_solver(model,src,trg,device)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ivlabs/repos/tfs/tranlslation-deq-main/solvers.py", line 399, in anderson_solver
    F[:,k%5],_ = f(X[:,k%5].view_as(x0).long(),y.long())#.view(bsz, -1)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ivlabs/anaconda3/envs/nlp2/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ivlabs/anaconda3/envs/nlp2/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ivlabs/repos/tfs/tranlslation-deq-main/model.py", line 34, in forward
    enc_output = self.enc(src, attention_mask=mask)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ivlabs/anaconda3/envs/nlp2/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ivlabs/anaconda3/envs/nlp2/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ivlabs/anaconda3/envs/nlp2/lib/python3.12/site-packages/transformers/models/bert/modeling_bert.py", line 1013, in forward
    encoder_outputs = self.encoder(
                      ^^^^^^^^^^^^^
  File "/home/ivlabs/anaconda3/envs/nlp2/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ivlabs/anaconda3/envs/nlp2/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ivlabs/anaconda3/envs/nlp2/lib/python3.12/site-packages/transformers/models/bert/modeling_bert.py", line 607, in forward
    layer_outputs = layer_module(
                    ^^^^^^^^^^^^^
  File "/home/ivlabs/anaconda3/envs/nlp2/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ivlabs/anaconda3/envs/nlp2/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ivlabs/anaconda3/envs/nlp2/lib/python3.12/site-packages/transformers/models/bert/modeling_bert.py", line 497, in forward
    self_attention_outputs = self.attention(
                             ^^^^^^^^^^^^^^^
  File "/home/ivlabs/anaconda3/envs/nlp2/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ivlabs/anaconda3/envs/nlp2/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ivlabs/anaconda3/envs/nlp2/lib/python3.12/site-packages/transformers/models/bert/modeling_bert.py", line 436, in forward
    attention_output = self.output(self_outputs[0], hidden_states)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ivlabs/anaconda3/envs/nlp2/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ivlabs/anaconda3/envs/nlp2/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ivlabs/anaconda3/envs/nlp2/lib/python3.12/site-packages/transformers/models/bert/modeling_bert.py", line 386, in forward
    hidden_states = self.dense(hidden_states)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ivlabs/anaconda3/envs/nlp2/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ivlabs/anaconda3/envs/nlp2/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ivlabs/anaconda3/envs/nlp2/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 116, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt